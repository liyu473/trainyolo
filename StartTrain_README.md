# StartTrain.py - YOLOè®­ç»ƒä¸€ä½“åŒ–è„šæœ¬

## åŠŸèƒ½ç‰¹æ€§

âœ… **è‡ªåŠ¨GPU/CPUæ£€æµ‹** - æ™ºèƒ½é€‰æ‹©æœ€ä½³è®­ç»ƒè®¾å¤‡  
âœ… **æ•°æ®é›†è‡ªåŠ¨å‡†å¤‡** - å°†åŸå§‹æ•°æ®è½¬æ¢ä¸ºYOLOæ ¼å¼  
âœ… **å®Œæ•´è®­ç»ƒæµç¨‹** - ä»æ•°æ®å‡†å¤‡åˆ°æ¨¡å‹è¾“å‡ºä¸€ç«™å¼å®Œæˆ  
âœ… **æ¨¡å‹æ–‡ä»¶ç®¡ç†** - è‡ªåŠ¨åˆ›å»ºå¸¦æ—¶é—´æˆ³çš„è¾“å‡ºç›®å½•ï¼Œé¿å…è¦†ç›–  
âœ… **ONNXæ ¼å¼å¯¼å‡º** - å¯é€‰çš„æ¨¡å‹æ ¼å¼è½¬æ¢  
âœ… **ä¸°å¯Œçš„é…ç½®é€‰é¡¹** - æ”¯æŒå‘½ä»¤è¡Œå‚æ•°è‡ªå®šä¹‰æ‰€æœ‰è®­ç»ƒå‚æ•°  

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®è®­ç»ƒ
python StartTrain.py --source-dir project-6-at-2025-10-29-15-54-bac1d4f3

# æŒ‡å®šè®­ç»ƒè½®æ•°
python StartTrain.py --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 --epochs 200

# å¯ç”¨ONNXå¯¼å‡º
python StartTrain.py --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 --export-onnx
```

### å®Œæ•´é…ç½®ç¤ºä¾‹
```bash
python StartTrain.py \
  --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 \
  --data-dir datasets \
  --epochs 200 \
  --batch-size 32 \
  --model-size yolo11s.pt \
  --export-onnx \
  --experiment-name checkpoint_detection \
  --learning-rate 0.01 \
  --cosine-lr
```

## å‚æ•°è¯´æ˜

### æ•°æ®é…ç½®
- `--source-dir`: åŸå§‹æ•°æ®é›†ç›®å½•ï¼ˆå¿…é¡»åŒ…å«images/å’Œlabels/æ–‡ä»¶å¤¹ï¼‰
- `--data-dir`: å¤„ç†åæ•°æ®é›†è¾“å‡ºç›®å½• (é»˜è®¤: datasets)
- `--prepare-data` / `--no-prepare-data`: æ˜¯å¦æ‰§è¡Œæ•°æ®å‡†å¤‡æ­¥éª¤
- `--train-split`: è®­ç»ƒé›†æ¯”ä¾‹ (é»˜è®¤: 0.8)

### è®­ç»ƒé…ç½®
- `--epochs`: è®­ç»ƒè½®æ•° (é»˜è®¤: 100)
- `--batch-size`: æ‰¹æ¬¡å¤§å° (é»˜è®¤: 16)
- `--image-size`: è¾“å…¥å›¾åƒå¤§å° (é»˜è®¤: 640)
- `--model-size`: é¢„è®­ç»ƒæ¨¡å‹ (yolo11n.pt/s/m/l/x.pt)
- `--resume-from`: ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒçš„æ¨¡å‹è·¯å¾„
- `--workers`: æ•°æ®åŠ è½½çº¿ç¨‹æ•° (é»˜è®¤: 8)
- `--patience`: æ—©åœè€å¿ƒå€¼ (é»˜è®¤: 50)

### ä¼˜åŒ–å™¨é…ç½®
- `--optimizer`: ä¼˜åŒ–å™¨é€‰æ‹© (SGD/Adam/AdamW/auto)
- `--learning-rate`: åˆå§‹å­¦ä¹ ç‡ (é»˜è®¤: 0.01)
- `--lr-final-ratio`: æœ€ç»ˆå­¦ä¹ ç‡æ¯”ç‡ (é»˜è®¤: 0.01)
- `--cosine-lr`: ä½¿ç”¨ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦å™¨
- `--cache`: å›¾åƒç¼“å­˜æ–¹å¼ (ram/disk/"")

### è®¾å¤‡é…ç½®
- `--force-cpu`: å¼ºåˆ¶ä½¿ç”¨CPUè®­ç»ƒ

### è¾“å‡ºé…ç½®
- `--model-output-dir`: æ¨¡å‹è¾“å‡ºæ ¹ç›®å½• (é»˜è®¤: Model)
- `--experiment-name`: å®éªŒåç§° (é»˜è®¤: yolo_train)
- `--export-onnx`: è®­ç»ƒå®Œæˆåå¯¼å‡ºONNXæ ¼å¼

## ç›®å½•ç»“æ„è¦æ±‚

### æºæ•°æ®ç›®å½•ç»“æ„
```
project-6-at-2025-10-29-15-54-bac1d4f3/
â”œâ”€â”€ images/           # å›¾åƒæ–‡ä»¶
â”‚   â”œâ”€â”€ img1.jpg
â”‚   â”œâ”€â”€ img2.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ labels/           # æ ‡æ³¨æ–‡ä»¶ï¼ˆYOLOæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ img1.txt
â”‚   â”œâ”€â”€ img2.txt
â”‚   â””â”€â”€ ...
â””â”€â”€ classes.txt       # ç±»åˆ«åç§°æ–‡ä»¶
```

### è¾“å‡ºç›®å½•ç»“æ„
```
Model/
â””â”€â”€ yolo_train_20241113_142500/    # å¸¦æ—¶é—´æˆ³çš„å®éªŒç›®å½•
    â”œâ”€â”€ train/
    â”‚   â”œâ”€â”€ weights/
    â”‚   â”‚   â”œâ”€â”€ best.pt           # æœ€ä½³æ¨¡å‹
    â”‚   â”‚   â””â”€â”€ last.pt           # æœ€ç»ˆæ¨¡å‹
    â”‚   â”œâ”€â”€ results.png
    â”‚   â””â”€â”€ ...
    â””â”€â”€ yolo_train_model.onnx     # ONNXæ¨¡å‹ï¼ˆå¦‚æœå¯ç”¨ï¼‰
```

## æ‰§è¡Œæµç¨‹

1. **ğŸ” è®¾å¤‡æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹GPUå¯ç”¨æ€§ï¼Œé€‰æ‹©æœ€ä½³è®­ç»ƒè®¾å¤‡
2. **ğŸ“Š æ•°æ®å‡†å¤‡**: å°†åŸå§‹æ•°æ®é›†è½¬æ¢ä¸ºYOLOè®­ç»ƒæ ¼å¼
3. **ğŸš€ æ¨¡å‹è®­ç»ƒ**: ä½¿ç”¨æŒ‡å®šå‚æ•°è®­ç»ƒYOLOæ¨¡å‹
4. **ğŸ“¦ æ¨¡å‹å¯¼å‡º**: ä¿å­˜è®­ç»ƒç»“æœåˆ°Modelæ–‡ä»¶å¤¹
5. **ğŸ”„ ONNXè½¬æ¢**: ï¼ˆå¯é€‰ï¼‰å°†æ¨¡å‹è½¬æ¢ä¸ºONNXæ ¼å¼

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿å®‰è£…äº†å¿…è¦çš„ä¾èµ–: `pip install torch ultralytics pyyaml`
- æºæ•°æ®ç›®å½•å¿…é¡»åŒ…å«`images/`å’Œ`labels/`æ–‡ä»¶å¤¹
- æ ‡æ³¨æ–‡ä»¶å¿…é¡»æ˜¯YOLOæ ¼å¼ï¼ˆæ¯è¡Œ: class_id x_center y_center width heightï¼‰
- æ¨¡å‹è¾“å‡ºä¼šè‡ªåŠ¨åˆ›å»ºå¸¦æ—¶é—´æˆ³çš„ç›®å½•ï¼Œé¿å…è¦†ç›–ä¹‹å‰çš„è®­ç»ƒç»“æœ
- å¦‚æœæœ‰å¤šä¸ªGPUï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ä½¿ç”¨æ‰€æœ‰å¯ç”¨GPUè¿›è¡Œè®­ç»ƒ

## é”™è¯¯æ’æŸ¥

### å¸¸è§é—®é¢˜
1. **"ç¼ºå°‘å¿…è¦çš„ä¾èµ–åŒ…"**: è¿è¡Œ `pip install torch ultralytics pyyaml`
2. **"æºæ•°æ®ç›®å½•ä¸å­˜åœ¨"**: æ£€æŸ¥ `--source-dir` å‚æ•°æ˜¯å¦æ­£ç¡®
3. **"æœªæ‰¾åˆ°ä»»ä½•å›¾åƒæ–‡ä»¶"**: ç¡®è®¤images/æ–‡ä»¶å¤¹ä¸­æœ‰jpg/pngæ ¼å¼çš„å›¾åƒ
4. **"æ•°æ®é…ç½®æ–‡ä»¶ä¸å­˜åœ¨"**: ç¡®è®¤æ•°æ®å‡†å¤‡æ­¥éª¤å·²æˆåŠŸå®Œæˆ

### æŸ¥çœ‹è®­ç»ƒè¯¦æƒ…
è®­ç»ƒå®Œæˆåï¼Œå¯ä»¥åœ¨è¾“å‡ºç›®å½•ä¸­æŸ¥çœ‹ï¼š
- `results.png`: è®­ç»ƒæ›²çº¿å›¾
- `confusion_matrix.png`: æ··æ·†çŸ©é˜µ
- `train/weights/best.pt`: æœ€ä½³æ¨¡å‹æƒé‡
- è¯¦ç»†æ—¥å¿—æ–‡ä»¶

## ç¤ºä¾‹ç”¨æ³•

### åœºæ™¯1: å¿«é€Ÿè®­ç»ƒæµ‹è¯•
```bash
python StartTrain.py --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 --epochs 50 --batch-size 8
```

### åœºæ™¯2: é«˜è´¨é‡è®­ç»ƒ
```bash
python StartTrain.py \
  --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 \
  --epochs 300 \
  --batch-size 32 \
  --model-size yolo11m.pt \
  --cosine-lr \
  --export-onnx \
  --experiment-name high_quality_model
```

### åœºæ™¯3: CPUè®­ç»ƒï¼ˆæ— GPUç¯å¢ƒï¼‰
```bash
python StartTrain.py \
  --source-dir project-6-at-2025-10-29-15-54-bac1d4f3 \
  --force-cpu \
  --batch-size 4 \
  --workers 2
```
