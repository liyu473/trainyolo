# starttrain.py - YOLOè®­ç»ƒä¸€ä½“åŒ–è„šæœ¬

## å¿«é€Ÿå¼€å§‹

### åŸºç¡€ä½¿ç”¨
```bash
# ä½¿ç”¨é»˜è®¤é…ç½®è®­ç»ƒ
python StartTrain.py --source-dir ä½ è§£å‹ä¹‹åçš„æ–‡ä»¶å¤¹è·¯å¾„

# æŒ‡å®šè®­ç»ƒè½®æ•°
python StartTrain.py --source-dir ä½ è§£å‹ä¹‹åçš„æ–‡ä»¶å¤¹è·¯å¾„ --epochs 200

# å¯ç”¨ONNXå¯¼å‡º
python StartTrain.py --source-dir ä½ è§£å‹ä¹‹åçš„æ–‡ä»¶å¤¹è·¯å¾„ --export-onnx

#ç­‰ç­‰å…¶ä»–å‚æ•°å¯ä»¥è‡ªå®šä¹‰é…ç½®
#å…·ä½“ä½¿ç”¨æ–¹å¼å¯ä»¥å‚è€ƒ example_usage.pyå’Œtrainyolo.py
```

### å®Œæ•´é…ç½®å’Œä½¿ç”¨ç¤ºä¾‹
```bash
from starttrain import start_train

if __name__ == '__main__':
    success3 = start_train(
        source_dir='project-6-at-2025-10-29-15-54-bac1d4f3', # label studio è§£å‹ä¹‹åçš„æ–‡ä»¶å¤¹åœ°å€
        data_dir='datasets', # å°†source_dirè½¬æ¢æˆæ•°æ®é›†ç›®å½•çš„ä¿å­˜ç›®å½•
        prepare_data=True,# æ˜¯å¦éœ€è¦å‡†å¤‡æ•°æ®é›†(å¦‚æœsource_dirå·²ç»æ˜¯æ•°æ®é›†ç›®å½•ï¼Œåˆ™ä¸éœ€è¦ï¼Œå¦‚æœæ˜¯labelstudioè§£å‹ä¹‹åçš„æ•°æ®ï¼Œåˆ™éœ€è¦)
        epochs=100, # è®­ç»ƒè½®æ¬¡
        batch_size=16, # æ‰¹æ¬¡å¤§å°
        experiment_name='my_test', # å®éªŒåç§°
        resume_from=None, # ä»å“ªä¸ªæ¨¡å‹çš„åŸºç¡€ä¸Šè¿›è¡Œè®­ç»ƒï¼Œå¦‚æœæ²¡æœ‰å°±æŒ‰ç…§é»˜è®¤model_dize(é»˜è®¤æ˜¯yolo11n.pt)è¿›è¡Œè®­ç»ƒ
        experiment_name='my_test', # å®éªŒåç§°
        model_output_dir='Model', # æ¨¡å‹è¾“å‡ºç›®å½•
        use_timestamp=True, # æ˜¯å¦ä½¿ç”¨æ—¶é—´æˆ³ä½œä¸ºå®éªŒåç§°
        export_onnx=False, # æ˜¯å¦å¯¼å‡ºonnx
        force_cpu=False, # æ˜¯å¦å¼ºåˆ¶ä½¿ç”¨CPU(é»˜è®¤ä½¿ç”¨GPU)
        image_size=640, # å›¾ç‰‡å°ºå¯¸
        learning_rate=0.01, # å­¦ä¹ ç‡
        workers=8, # çº¿ç¨‹æ•°
    )

    print(f"\nğŸ“Š è®­ç»ƒç»“æœ:")
    print(f"  ç»“æœ: {'âœ…æˆåŠŸ' if success3['success'] else 'âŒå¤±è´¥'}")
    
    # æ‰“å°æ¨¡å‹ä¿å­˜è·¯å¾„
    print(f"\nğŸ“ æ¨¡å‹ä¿å­˜ä½ç½®:")  
    print(f"  æ¨¡å‹: {success3['model_dir']}")
    print(f"  æœ€ä½³æ¨¡å‹: {success3['best_model']}")
    if success3['onnx_model']:
        print(f"  ONNXæ¨¡å‹: {success3['onnx_model']}")

```

## å‚æ•°è¯´æ˜

### æ•°æ®é…ç½®
- `--source-dir`: åŸå§‹æ•°æ®é›†ç›®å½•ï¼ˆå¿…é¡»åŒ…å«images/å’Œlabels/æ–‡ä»¶å¤¹ï¼‰
- `--data-dir`: å¤„ç†åæ•°æ®é›†è¾“å‡ºç›®å½• (é»˜è®¤: datasets)
- `--prepare-data` / `--no-prepare-data`: æ˜¯å¦æ‰§è¡Œæ•°æ®å‡†å¤‡æ­¥éª¤
- `--train-split`: è®­ç»ƒé›†æ¯”ä¾‹ (é»˜è®¤: 0.8)

### è®­ç»ƒé…ç½®
- `--epochs`: è®­ç»ƒè½®æ•° (é»˜è®¤: 100)
- `--batch-size`: æ‰¹æ¬¡å¤§å° (é»˜è®¤: 16)
- `--image-size`: è¾“å…¥å›¾åƒå¤§å° (é»˜è®¤: 640)
- `--model-size`: é¢„è®­ç»ƒæ¨¡å‹ (yolo11n.pt/s/m/l/x.pt)
- `--resume-from`: ä»æ£€æŸ¥ç‚¹æ¢å¤è®­ç»ƒçš„æ¨¡å‹è·¯å¾„
- `--workers`: æ•°æ®åŠ è½½çº¿ç¨‹æ•° (é»˜è®¤: 8)
- `--patience`: æ—©åœè€å¿ƒå€¼ (é»˜è®¤: 50)

### ä¼˜åŒ–å™¨é…ç½®
- `--optimizer`: ä¼˜åŒ–å™¨é€‰æ‹© (SGD/Adam/AdamW/auto)
- `--learning-rate`: åˆå§‹å­¦ä¹ ç‡ (é»˜è®¤: 0.01)
- `--lr-final-ratio`: æœ€ç»ˆå­¦ä¹ ç‡æ¯”ç‡ (é»˜è®¤: 0.01)
- `--cosine-lr`: ä½¿ç”¨ä½™å¼¦å­¦ä¹ ç‡è°ƒåº¦å™¨
- `--cache`: å›¾åƒç¼“å­˜æ–¹å¼ (ram/disk/"")

### è®¾å¤‡é…ç½®
- `--force-cpu`: å¼ºåˆ¶ä½¿ç”¨CPUè®­ç»ƒ

### è¾“å‡ºé…ç½®
- `--model-output-dir`: æ¨¡å‹è¾“å‡ºæ ¹ç›®å½• (é»˜è®¤: Model)
- `--experiment-name`: å®éªŒåç§° (é»˜è®¤: yolo_train)
- `--export-onnx`: è®­ç»ƒå®Œæˆåå¯¼å‡ºONNXæ ¼å¼

## ç›®å½•ç»“æ„è¦æ±‚

### æºæ•°æ®ç›®å½•ç»“æ„
```
project-6-at-2025-10-29-15-54-bac1d4f3/
â”œâ”€â”€ images/           # å›¾åƒæ–‡ä»¶
â”‚   â”œâ”€â”€ img1.jpg
â”‚   â”œâ”€â”€ img2.png
â”‚   â””â”€â”€ ...
â”œâ”€â”€ labels/           # æ ‡æ³¨æ–‡ä»¶ï¼ˆYOLOæ ¼å¼ï¼‰
â”‚   â”œâ”€â”€ img1.txt
â”‚   â”œâ”€â”€ img2.txt
â”‚   â””â”€â”€ ...
â””â”€â”€ classes.txt       # ç±»åˆ«åç§°æ–‡ä»¶
```

### è¾“å‡ºç›®å½•ç»“æ„
```
Model/
â””â”€â”€ yolo_train_20241113_142500/    # å¸¦æ—¶é—´æˆ³çš„å®éªŒç›®å½•
    â”œâ”€â”€ train/
    â”‚   â”œâ”€â”€ weights/
    â”‚   â”‚   â”œâ”€â”€ best.pt           # æœ€ä½³æ¨¡å‹
    â”‚   â”‚   â””â”€â”€ last.pt           # æœ€ç»ˆæ¨¡å‹
    â”‚   â”œâ”€â”€ results.png
    â”‚   â””â”€â”€ ...
    â””â”€â”€ yolo_train_model.onnx     # ONNXæ¨¡å‹ï¼ˆå¦‚æœå¯ç”¨ï¼‰
```

## æ‰§è¡Œæµç¨‹

1. **ğŸ” è®¾å¤‡æ£€æµ‹**: è‡ªåŠ¨æ£€æµ‹GPUå¯ç”¨æ€§ï¼Œæœ‰ç‹¬æ˜¾é»˜è®¤ä½¿ç”¨gpu
2. **ğŸ“Š æ•°æ®å‡†å¤‡**: å°†åŸå§‹æ•°æ®é›†è½¬æ¢ä¸ºYOLOè®­ç»ƒæ ¼å¼
3. **ğŸš€ æ¨¡å‹è®­ç»ƒ**: ä½¿ç”¨æŒ‡å®šå‚æ•°è®­ç»ƒYOLOæ¨¡å‹
4. **ğŸ“¦ æ¨¡å‹å¯¼å‡º**: ä¿å­˜è®­ç»ƒç»“æœåˆ°Modelæ–‡ä»¶å¤¹
5. **ğŸ”„ ONNXè½¬æ¢**: ï¼ˆå¯é€‰ï¼‰å°†æ¨¡å‹è½¬æ¢ä¸ºONNXæ ¼å¼

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿å®‰è£…äº†å¿…è¦çš„ä¾èµ–: `pip install torch ultralytics pyyaml`
- æºæ•°æ®ç›®å½•å¿…é¡»åŒ…å«`images/`å’Œ`labels/`æ–‡ä»¶å¤¹
- æ ‡æ³¨æ–‡ä»¶å¿…é¡»æ˜¯YOLOæ ¼å¼ï¼ˆæ¯è¡Œ: class_id x_center y_center width heightï¼‰
- æ¨¡å‹è¾“å‡ºä¼šè‡ªåŠ¨åˆ›å»ºå¸¦æ—¶é—´æˆ³çš„ç›®å½•ï¼Œé¿å…è¦†ç›–ä¹‹å‰çš„è®­ç»ƒç»“æœ
- å¦‚æœæœ‰å¤šä¸ªGPUï¼Œè„šæœ¬ä¼šè‡ªåŠ¨ä½¿ç”¨æ‰€æœ‰å¯ç”¨GPUè¿›è¡Œè®­ç»ƒ

## é”™è¯¯æ’æŸ¥

### å¸¸è§é—®é¢˜
1. **"ç¼ºå°‘å¿…è¦çš„ä¾èµ–åŒ…"**: è¿è¡Œ `pip install torch ultralytics pyyaml`
2. **"æºæ•°æ®ç›®å½•ä¸å­˜åœ¨"**: æ£€æŸ¥ `--source-dir` å‚æ•°æ˜¯å¦æ­£ç¡®
3. **"æœªæ‰¾åˆ°ä»»ä½•å›¾åƒæ–‡ä»¶"**: ç¡®è®¤images/æ–‡ä»¶å¤¹ä¸­æœ‰jpg/pngæ ¼å¼çš„å›¾åƒ
4. **"æ•°æ®é…ç½®æ–‡ä»¶ä¸å­˜åœ¨"**: ç¡®è®¤æ•°æ®å‡†å¤‡æ­¥éª¤å·²æˆåŠŸå®Œæˆ
